function initMap(){function e(e){markerNew=new google.maps.Marker({position:e,map:t,animation:google.maps.Animation.DROP,draggable:!0}),void 0!=oldMarker&&oldMarker.setMap(null),void 0!=o&&o.setMap(null),oldMarker=markerNew,t.setCenter(e);var n=markerNew.getPosition().lat(),a=markerNew.getPosition().lng();$("#lat").val(n),$("#lng").val(a),google.maps.event.addListener(markerNew,"position_changed",function(){var e=markerNew.getPosition().lat(),t=markerNew.getPosition().lng();$("#lat").val(e),$("#lng").val(t)})}var t=new google.maps.Map(document.getElementById("map-canvas"),{center:{lat:lat,lng:lng},zoom:12});if(""!=latitute&&""!=lngitute){var o=new google.maps.Marker({position:{lat:lat,lng:lng},map:t,draggable:!0}),n=new google.maps.places.SearchBox(document.getElementById("searchmap"));google.maps.event.addListener(n,"places_changed",function(){var e,a,i=n.getPlaces(),l=new google.maps.LatLngBounds;for(e=0;a=i[e];e++)l.extend(a.geometry.location),o.setPosition(a.geometry.location);t.fitBounds(l),t.setZoom(12)}),google.maps.event.addListener(o,"position_changed",function(){var e=o.getPosition().lat(),t=o.getPosition().lng();$("#lat").val(e),$("#lng").val(t)}),google.maps.event.addListener(t,"click",function(t){e(t.latLng)})}else infoWindow=new google.maps.InfoWindow,navigator.geolocation?navigator.geolocation.getCurrentPosition(function(e){function o(e){markerNew=new google.maps.Marker({position:e,map:t,animation:google.maps.Animation.DROP,draggable:!0}),void 0!=oldMarker&&oldMarker.setMap(null),void 0!=a&&a.setMap(null),oldMarker=markerNew,t.setCenter(e);var o=markerNew.getPosition().lat(),n=markerNew.getPosition().lng();$("#lat").val(o),$("#lng").val(n),google.maps.event.addListener(markerNew,"position_changed",function(){var e=markerNew.getPosition().lat(),t=markerNew.getPosition().lng();$("#lat").val(e),$("#lng").val(t)})}var n={lat:e.coords.latitude,lng:e.coords.longitude},a=new google.maps.Marker({position:{lat:e.coords.latitude,lng:e.coords.longitude},map:t,draggable:!0,mapTypeId:google.maps.MapTypeId.ROADMAP,streetViewControl:!1,mapTypeControl:!1});google.maps.event.addListener(a,"position_changed",function(){var e=a.getPosition().lat(),t=a.getPosition().lng();$("#lat").val(e),$("#lng").val(t)}),google.maps.event.addListener(t,"click",function(e){o(e.latLng)}),infoWindow.setPosition(n),infoWindow.setContent("Location found."),infoWindow.open(t),t.setCenter(n)},function(){handleLocationError(!0,infoWindow,t.getCenter())}):handleLocationError(!1,infoWindow,t.getCenter())}$(".select3").select2({language:"fa",dropdownAutoWidth:"true"}),$("#state_id").on("change",function(){var e=$(this).find("option:selected").val();$.get("{{URL::to("/api/main/cities/")}}/"+e,function(e){$("#city_id").html('<option value="" selected>لطفا شهر را انتخاب کنید ...</option>'),$("#city_id").select2({data:e.city}),$("#tel").val(e.areacode)})}),$(document).ready(function(){var e=$("#state_id").find("option:selected").val(),t=$("#city_id").find("option:selected").val(),o=$("#location_id").find("option:selected").val();e&&t&&(event.preventDefault(),$.get("{{URL::to("/api/main/cities/")}}/"+e,function(e){$("#city_id").html('<option value="'+t+'" selected>شهر</option>'),$("#city_id").select2({data:e.city})}),o&&$.get("{{URL::to("/api/main/areacode/")}}/"+t,function(e){$("#location_id").html('<option value="'+o+'" selected>انتخاب محله</option>'),$("#location_id").select2({data:e.location})}))}),$("#city_id").on("change",function(){var e=$(this).find("option:selected").val();$.get("{{URL::to("/api/main/areacode/")}}/"+e,function(e){$("#location_id").html('<option value="" selected>لطفا محله را انتخاب کنید ...</option>'),$("#tel").val(e.areacode),$("#location_id").select2({data:e.location})})}),$.fn.modal.Constructor.prototype.enforceFocus=function(){};var latitute=$("#lat").val(),lngitute=$("#lng").val();if(""!=latitute&&""!=lngitute)var lat=Number(latitute),lng=Number(lngitute);else var lat=35.837850811893915,lng=50.945327148437514;var map,infoWindow,oldMarker;